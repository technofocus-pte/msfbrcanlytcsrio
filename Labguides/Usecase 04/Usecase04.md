# ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹04: Apache Sparkã§ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã™ã‚‹

**å°å…¥**

Apache
Sparkã¯ã€åˆ†æ•£ãƒ‡ãƒ¼ã‚¿å‡¦ç†ç”¨ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³ã§ã‚ã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ã‚¯ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å†…ã®è†¨å¤§ãªãƒ‡ãƒ¼ã‚¿ã®æ¢ç´¢ã€å‡¦ç†ã€åˆ†æã«åºƒãåˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚Sparkã¯ã€Azure
HDInsightã€Azure Databricksã€Azure Synapse Analyticsã€Microsoft
Fabricãªã©ã€å¤šãã®ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ è£½å“ã®å‡¦ç†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚Sparkã®åˆ©ç‚¹ã®ä¸€ã¤ã¯ã€Javaã€Scalaã€Pythonã€
SQLãªã©ã€å¹…åºƒã„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Sparkã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ¬ãƒ³ã‚¸ãƒ³ã‚°ã¨æ“ä½œã€çµ±è¨ˆåˆ†æã¨æ©Ÿæ¢°å­¦ç¿’ã€ãƒ‡ãƒ¼ã‚¿åˆ†æã¨å¯è¦–åŒ–ã¨ã„ã£ãŸãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰ã«éå¸¸ã«æŸ”è»Ÿãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚

Microsoft
FabricLakehouseã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã«åŸºã¥ã„ã¦ã„ã¾ã™Â Apache Spark
ç”¨ã®*Delta Lake*å½¢å¼ã€‚Delta Lake
ã¯ã€ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿æ“ä½œã¨ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿æ“ä½œã®ä¸¡æ–¹ã«ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã®ã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ ã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ã‚¯å†…ã®åŸºç›¤ãƒ•ã‚¡ã‚¤ãƒ«ã«åŸºã¥ããƒ†ãƒ¼ãƒ–ãƒ«å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’
Apache Spark ã‚’ä½¿ç”¨ã—ã¦å‡¦ç†ãŠã‚ˆã³ã‚¯ã‚¨ãƒªã§ãã‚‹ Lakehouse
ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä½œæˆã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

Microsoft Fabric ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ (Gen2)
ãŒæ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«æ¥ç¶šã—ã€Power Query Online
ã§å¤‰æ›ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ãã®å¾Œã€ãƒ‡ãƒ¼ã‚¿
ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€Lakehouseã‚„ãã®ä»–ã®åˆ†æã‚¹ãƒˆã‚¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã€Power
BI ãƒ¬ãƒãƒ¼ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

)ã®ã•ã¾ã–ã¾ãªè¦ç´ ã‚’ç´¹ä»‹ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€ä¼æ¥­å†…ã«å­˜åœ¨ã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹è¤‡é›‘ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

**ç›®çš„**:

- Fabric ã®è©¦ç”¨ç‰ˆã‚’æœ‰åŠ¹ã«ã—ã¦ã€Microsoft Fabric
  ã«ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

- Lakehouseç’°å¢ƒã‚’ç¢ºç«‹ã—ã€åˆ†æç”¨ã®ãƒ‡ãƒ¼ã‚¿ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

- ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿ã®æ¢ç´¢ã¨åˆ†æã®ãŸã‚ã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

- ã•ã‚‰ã«å‡¦ç†ã—ã¦è¦–è¦šåŒ–ã™ã‚‹ãŸã‚ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«èª­ã¿è¾¼ã¿ã¾ã™ã€‚

- PySparkã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã‚’é©ç”¨ã—ã¾ã™ã€‚

- ã‚¯ã‚¨ãƒªã‚’æœ€é©åŒ–ã™ã‚‹ãŸã‚ã«ã€å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¦ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã—ã¾ã™ã€‚

- æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã®ãŸã‚ã«Sparkãƒ¡ã‚¿ã‚¹ãƒˆã‚¢ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹

- DataFrame ã‚’ã€Œ salesorders ã€ã¨ã„ã†åå‰ã®ç®¡ç†ã•ã‚ŒãŸãƒ‡ãƒ«ã‚¿
  ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦ä¿å­˜ã—ã¾ã™ã€‚

- æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã‚’æŒã¤ã€Œ external_salesorder ã€ã¨ã„ã†åå‰ã®å¤–éƒ¨ãƒ‡ãƒ«ã‚¿
  ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦DataFrame ã‚’ä¿å­˜ã—ã¾ã™ã€‚

- ç®¡ç†å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã¨å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã¤ã„ã¦èª¬æ˜ã—ã€æ¯”è¼ƒã—ã¾ã™ã€‚

- åˆ†æã¨ãƒ¬ãƒãƒ¼ãƒˆã®ãŸã‚ã«ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã—ã¦ SQL ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

- matplotlib ã‚„ seaborn ãªã©ã® Python
  ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’è¦–è¦šåŒ–ã—ã¾ã™ã€‚

- ãƒ‡ãƒ¼ã‚¿ ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°
  ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã§ãƒ‡ãƒ¼ã‚¿Lakehouseã‚’ç¢ºç«‹ã—ã€å¾Œç¶šã®åˆ†æã®ãŸã‚ã«é–¢é€£ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã¾ã™ã€‚

- ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã€å¤‰æ›ã—ã€Lakehouseã«ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’å®šç¾©ã—ã¾ã™ã€‚

- å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’Lakehouseã«ä¿å­˜ã™ã‚‹ã‚ˆã†ã«ã€Power Query
  å†…ã§ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å…ˆã‚’æ§‹æˆã—ã¾ã™ã€‚

- ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ„ã¿è¾¼ã‚“ã§ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿å‡¦ç†ã¨å–ã‚Šè¾¼ã¿ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚

- æ¼”ç¿’ã‚’çµ‚äº†ã™ã‚‹ã«ã¯ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã¨é–¢é€£è¦ç´ ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

# æ¼”ç¿’ 1: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã€Lakehouseã€ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ 

## ã‚¿ã‚¹ã‚¯1: ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½œæˆã™ã‚‹

Fabric ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹å‰ã«ã€Fabric
ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

1.  ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‹ãã€ã‚¢ãƒ‰ãƒ¬ã‚¹ ãƒãƒ¼ã«ç§»å‹•ã—ã¦ã€æ¬¡ã® URL
    ã‚’å…¥åŠ›ã¾ãŸã¯è²¼ã‚Šä»˜ã‘ã¾ã™: + ++ https://app.fabric.microsoft.com/+++
    **Enter**ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¾ã™ã€‚

> **æ³¨**: Microsoft Fabric ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ãŸå ´åˆã¯ã€æ‰‹é † 2 ã‹ã‚‰ 4
> ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚
>
> ![](./media/image1.png)

2.  **Microsoft Fabric**ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è³‡æ ¼æƒ…å ±ã‚’å…¥åŠ›ã—ã€
    **\[Submit\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> ![](./media/image2.png)

3.  æ¬¡ã«ã€ **Microsoft**ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã€ **\[Sign
    in\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™**ã€‚**

> ![A login screen with a red box and blue text Description
> automatically generated](./media/image3.png)

4.  **ã€ŒStay signed in?ã€ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦**ã§ã€
    **ã€ŒYesã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> ![A screenshot of a computer error Description automatically
> generated](./media/image4.png)

5.  Fabricãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã€ **+ New workspace**ã‚’é¸æŠã—ã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image5.png)

6.  **ã€ŒCreate a workspaceã€**ã‚¿ãƒ–ã§ã€æ¬¡ã®è©³ç´°ã‚’å…¥åŠ›ã—ã€
    **ã€ŒApplyã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

[TABLE]

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image6.png)
>
> ![](./media/image7.png)

7.  ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã™ã‚‹ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€‚å®Œäº†ã¾ã§2ï½3åˆ†ã‹ã‹ã‚Šã¾ã™ã€‚æ–°ã—ã„ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãŒé–‹ã„ãŸã‚‰ã€ä¸­èº«ã¯ç©ºã«ãªã£ã¦ã„ã‚‹ã¯ãšã§ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image8.png)

## ã‚¿ã‚¹ã‚¯2:Lakehouseã‚’ä½œæˆã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹

ãƒãƒ¼ã‚¿ãƒ«ã§*ãƒ‡ãƒ¼ã‚¿
ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹*ã«åˆ‡ã‚Šæ›¿ãˆã¦ã€åˆ†æã™ã‚‹ãƒ‡ãƒ¼ã‚¿
ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã®ãƒ‡ãƒ¼ã‚¿Lakehouseã‚’ä½œæˆã—ã¾ã™ã€‚

1.  ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ ãƒãƒ¼ã®**+ New
    item**Â ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€æ–°ã—ã„Eventhouseã‚’ä½œæˆã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image9.png)

2.  ã€Œ**Lakehouse**ã€ã‚¿ã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image10.png)

3.  **\[New Lakehouse\]**ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒœãƒƒã‚¯ã‚¹ã§ã€
    \[**Name\]**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«**ã€Œ +++ Fabric_lakehouse +++ ã€**ã¨å…¥åŠ›ã—ã€
    **\[Create\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ–°ã—ã„Lakehouseã‚’é–‹ãã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image11.png)

4.  1åˆ†ã»ã©çµŒã¤ã¨ã€æ–°ã—ã„ç©ºã®LakehouseãŒä½œæˆã•ã‚Œã¾ã™ã€‚åˆ†æã®ãŸã‚ã«ã€ãƒ‡ãƒ¼ã‚¿Lakehouseã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ã‚¸ã‚§ã‚¹ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![](./media/image12.png)

5.  **ã€ŒSuccessfully created SQL endpointã€**ã¨ã„ã†é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](./media/image13.png)

6.  **Explorer**ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®**fabric_lakehouse**ã®ä¸‹ã§ã€**Files**ãƒ•ã‚©ãƒ«ãƒ€**ã®**æ¨ªã«ãƒã‚¦ã‚¹ã‚’ç§»å‹•ã—ã€æ°´å¹³ã®çœç•¥è¨˜å·**(â€¦)**ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ç§»å‹•ã—ã¦**Upload**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
    ã‚¯ãƒªãƒƒã‚¯ ä¸‹ã®ç”»åƒã«ç¤ºã™ã‚ˆã†ã«ã€**Upload**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã‚ã‚Šã¾ã™ã€‚

![](./media/image14.png)

7.  å³å´ã«è¡¨ç¤ºã•ã‚Œã‚‹**Upload**ãƒ•ã‚©ãƒ«ãƒ€ãƒšã‚¤ãƒ³ã§ã€
    **Files/ã®**ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸æŠã—ã€
    **C:\LabFiles**ã‚’å‚ç…§ã—ã¦æ³¨æ–‡ã‚’é¸æŠã—ã¾ã™ã€‚
    ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ç§»å‹•ã—ã€\[**Upload\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![](./media/image15.png)

8.  **ã€ŒUpload 3 files to this site?ã€ã¨ã„ã†**ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
    ãƒœãƒƒã‚¯ã‚¹ãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆã¯ã€ **ã€ŒUploadã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![](./media/image16.png)

9.  \[Upload folder\] ãƒšã‚¤ãƒ³ã§ã€\[**Upload\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> ![](./media/image17.png)

10. ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã‚‰ã€ ã€Œ**Upload
    folderã€**ãƒšã‚¤ãƒ³ã‚’é–‰ã˜ã¾ã™ã€‚

> ![](./media/image18.png)

11. **\[Files\]**ã‚’å±•é–‹ã—ã€**orders** ãƒ•ã‚©ãƒ«ãƒ€ã‚’é¸æŠã—ã¦ã€CSV
    ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

> ![](./media/image19.png)

## ã‚¿ã‚¹ã‚¯3: ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆã™ã‚‹

*ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯*ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯ã€ï¼ˆè¤‡æ•°ã®è¨€èªã§ï¼‰ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¿°ã—ã¦å®Ÿè¡Œã—ã€ãƒ¡ãƒ¢ã‚’è¿½åŠ ã—ã¦è¨˜éŒ²ã§ãã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªç’°å¢ƒã‚’æä¾›ã—ã¾ã™ã€‚

1.  **Home**ãƒšãƒ¼ã‚¸ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ã‚¯ã®**orders**ãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹ã‚’è¡¨ç¤ºã—ã¦ã„ã‚‹ã¨ãã«ã€
    **\[Open notebook\]**ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§**\[New notebook\]**ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image20.png)

2.  æ•°ç§’å¾Œã€1ã¤ã®*ã‚»ãƒ«ã‚’å«ã‚€æ–°ã—ã„ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ãŒé–‹ãã¾ã™ã€‚ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯ã€ã‚³ãƒ¼ãƒ‰*ã¾ãŸã¯*ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³*ï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’å«ã‚€1ã¤ä»¥ä¸Šã®ã‚»ãƒ«ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚

![](./media/image21.png)

3.  æœ€åˆã®ã‚»ãƒ« (ç¾åœ¨ã¯*ã‚³ãƒ¼ãƒ‰*ã‚»ãƒ«) ã‚’é¸æŠã—ã€å³ä¸Šã«ã‚ã‚‹å‹•çš„ãƒ„ãƒ¼ãƒ«
    ãƒãƒ¼ã§**Mâ†“**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€**ã‚»ãƒ«ã‚’ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³
    ã‚»ãƒ«ã«å¤‰æ›ã—ã¾ã™**ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image22.png)

4.  ã‚»ãƒ«ãŒãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³
    ã‚»ãƒ«ã«å¤‰æ›´ã•ã‚Œã‚‹ã¨ã€ãã“ã«å«ã¾ã‚Œã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚

![](./media/image23.png)

5.  **ğŸ–‰**
    (ç·¨é›†)ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã‚»ãƒ«ã‚’ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã€ã™ã¹ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç½®ãæ›ãˆã¦ã‹ã‚‰ã€æ¬¡ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’å¤‰æ›´ã—ã¾ã™ã€‚

> CodeCopy
>
> \# Sales order data exploration
>
> Use the code in this notebook to explore sales order data.

![](./media/image24.png)

![A screenshot of a computer Description automatically
generated](./media/image25.png)

6.  ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ã‚»ãƒ«ã®å¤–å´ã®ä»»æ„ã®å ´æ‰€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image26.png)

## ã‚¿ã‚¹ã‚¯4: ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹

ã“ã‚Œã§ã€ãƒ‡ãƒ¼ã‚¿ã‚’*ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«èª­ã¿è¾¼ã‚€ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹æº–å‚™ãŒæ•´ã„ã¾ã—ãŸ*ã€‚Sparkã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¯
Pythonã®Pandasãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ä¼¼ã¦ãŠã‚Šã€è¡Œã¨åˆ—ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®å…±é€šæ§‹é€ ã‚’æä¾›ã—ã¾ã™ã€‚

**æ³¨**ï¼šSparkã¯Scalaã€Javaãªã©ã€è¤‡æ•°ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¨€èªã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ã“ã®æ¼”ç¿’ã§ã¯ã€
Sparkå‘ã‘ã«æœ€é©åŒ–ã•ã‚ŒãŸPythonã§ã‚ã‚‹*PySparkã‚’ä½¿ç”¨ã—ã¾ã™ã€‚PySpark*ã¯Sparkã§æœ€ã‚‚ã‚ˆãä½¿ã‚ã‚Œã‚‹è¨€èªã®1ã¤ã§ã‚ã‚Šã€Fabricãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨€èªã§ã™ã€‚

1.  ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã§ã€ **\[Files\]**ãƒªã‚¹ãƒˆã‚’å±•é–‹ã—ã€
    **orders**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’é¸æŠã—ã¦ã€CSV ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯
    ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®æ¨ªã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

![](./media/image27.png)

2.  ã•ã¦ã€ãƒã‚¦ã‚¹ã‚’2019.csvãƒ•ã‚¡ã‚¤ãƒ«ã«ç§»å‹•ã—ã¦ãã ã•ã„ã€‚2019.csvã®æ¨ªã«ã‚ã‚‹æ°´å¹³ã®çœç•¥è¨˜å·ï¼ˆâ€¦ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
    **ã€ŒLoad dataã€**ã«ç§»å‹•ã—ã€
    **ã€ŒSparkã€**ã‚’é¸æŠã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ãŒãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚

> CodeCopy
>
> df =
> spark.read.format("csv").option("header","true").load("Files/orders/2019.csv")
>
> \# df now is a Spark DataFrame containing CSV data from
> "Files/orders/2019.csv".
>
> display(df)
>
> ![](./media/image28.png)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image29.png)

**ãƒ’ãƒ³ãƒˆ**ï¼šå·¦å´ã®Lakehouse explorerãƒ‘ãƒãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹ã«ã¯ã€
**ã€Œã€**ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«é›†ä¸­ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

3.  ã‚»ãƒ«ã®å·¦å´ã«ã‚ã‚‹**â–·ã‚»ãƒ«å®Ÿè¡Œãƒœã‚¿ãƒ³**ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image30.png)

**æ³¨**ï¼šSparkã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã®ã¯åˆã‚ã¦ãªã®ã§ã€Sparkã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ€åˆã®å®Ÿè¡Œã«ã¯1åˆ†ã»ã©ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãã®å¾Œã®å®Ÿè¡Œã¯ã‚ˆã‚ŠçŸ­ããªã‚Šã¾ã™ã€‚

4.  ã‚»ãƒ«
    ã‚³ãƒãƒ³ãƒ‰ãŒå®Œäº†ã—ãŸã‚‰ã€ã‚»ãƒ«ã®ä¸‹ã®å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚å‡ºåŠ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image31.png)

5.  å‡ºåŠ›ã«ã¯ã€2019.csvãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã®è¡Œã¨åˆ—ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãŸã ã—ã€åˆ—ãƒ˜ãƒƒãƒ€ãƒ¼ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€CSVãƒ•ã‚¡ã‚¤ãƒ«ã®1è¡Œç›®ã«åˆ—åãŒå«ã¾ã‚Œã¦ã„ã‚‹ã¨æƒ³å®šã•ã‚Œã¦ã„ã¾ã™ãŒã€ã“ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã®ãªã„ãƒ‡ãƒ¼ã‚¿ã®ã¿ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

6.  ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã¦ã€**ãƒ˜ãƒƒãƒ€ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’false**ã«è¨­å®šã—ã¾ã™ã€‚**ã‚»ãƒ«**å†…ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã€
    **â–·ã‚»ãƒ«å®Ÿè¡Œ**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚

> CodeCopy
>
> df =
> spark.read.format("csv").option("header","false").load("Files/orders/2019.csv")
>
> \# df now is a Spark DataFrame containing CSV data from
> "Files/orders/2019.csv".
>
> display(df)

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image32.png)

7.  ã“ã‚Œã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®æœ€åˆã®è¡Œã¯ãƒ‡ãƒ¼ã‚¿å€¤ã¨ã—ã¦æ­£ã—ãå«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸãŒã€åˆ—åã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ãŠã‚Šã€ã‚ã¾ã‚Šå½¹ã«ç«‹ã¡ã¾ã›ã‚“ã€‚ãƒ‡ãƒ¼ã‚¿ã‚’ç†è§£ã™ã‚‹ã«ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ãƒ‡ãƒ¼ã‚¿å€¤ã«å¯¾ã—ã¦æ­£ã—ã„ã‚¹ã‚­ãƒ¼ãƒã¨ãƒ‡ãƒ¼ã‚¿å‹ã‚’æ˜ç¤ºçš„ã«å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

8.  **ã‚»ãƒ«**å†…ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã€
    **â–·ã‚»ãƒ«å®Ÿè¡Œ**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚

> from pyspark.sql.types import \*
>
> orderSchema = StructType(\[
>
> StructField("SalesOrderNumber", StringType()),
>
> StructField("SalesOrderLineNumber", IntegerType()),
>
> StructField("OrderDate", DateType()),
>
> StructField("CustomerName", StringType()),
>
> StructField("Email", StringType()),
>
> StructField("Item", StringType()),
>
> StructField("Quantity", IntegerType()),
>
> StructField("UnitPrice", FloatType()),
>
> StructField("Tax", FloatType())
>
> \])
>
> df =
> spark.read.format("csv").schema(orderSchema).load("Files/orders/2019.csv")
>
> display(df)
>
> ![](./media/image33.png)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image34.png)

9.  ã“ã‚Œã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«æ­£ã—ã„åˆ—åï¼ˆå„è¡Œã®é †åºã«åŸºã¥ã„ã¦ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹åˆ—**Index**ã«åŠ ãˆã¦ï¼‰ãŒå«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚åˆ—ã®ãƒ‡ãƒ¼ã‚¿å‹ã¯ã€ã‚»ãƒ«ã®å…ˆé ­ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸ
    Spark SQL
    ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹æ¨™æº–ã®å‹ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦æŒ‡å®šã•ã‚Œã¾ã™ã€‚

10. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¡¨ç¤ºã—ã¦ã€å¤‰æ›´ãŒãƒ‡ãƒ¼ã‚¿ã«é©ç”¨ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

11. ã‚»ãƒ«å‡ºåŠ›ã®ä¸‹ã«ã‚ã‚‹**ã€Œ+Codeã€**ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’è¿½åŠ ã—ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚
    **â–· ã€Œã‚»ãƒ«ã‚’å®Ÿè¡Œã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚

> CodeCopy
>
> display(df)
>
> ![](./media/image35.png)

12. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ã¯**2019.csv**ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã«ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã€Œ\*ã€ã‚’ä½¿ç”¨ã—ã¦ã€
    **orders**ãƒ•ã‚©ãƒ«ãƒ€å†…ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è²©å£²æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã£ã¦ãã ã•ã„ã€‚

13. ã‚»ãƒ«å‡ºåŠ›ã®ä¸‹ã«ã‚ã‚‹**+
    Code**ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«æ–°ã—ã„ã‚³ãƒ¼ãƒ‰
    ã‚»ãƒ«ã‚’è¿½åŠ ã—ã€ãã“ã«æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

CodeCopy

> from pyspark.sql.types import \*
>
> orderSchema = StructType(\[
>
> Â  Â  StructField("SalesOrderNumber", StringType()),
>
> Â  Â  StructField("SalesOrderLineNumber", IntegerType()),
>
> Â  Â  StructField("OrderDate", DateType()),
>
> Â  Â  StructField("CustomerName", StringType()),
>
> Â  Â  StructField("Email", StringType()),
>
> Â  Â  StructField("Item", StringType()),
>
> Â  Â  StructField("Quantity", IntegerType()),
>
> Â  Â  StructField("UnitPrice", FloatType()),
>
> Â  Â  StructField("Tax", FloatType())
>
> Â  Â  \])
>
> df =
> spark.read.format("csv").schema(orderSchema).load("Files/orders/\*.csv")
>
> display(df)
>
> ![](./media/image36.png)

14. å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰ ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã€å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚å‡ºåŠ›ã«ã¯ 2019
    å¹´ã€2020 å¹´ã€2021 å¹´ã®å£²ä¸ŠãŒå«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image37.png)

**æ³¨**:
è¡Œã®ã‚µãƒ–ã‚»ãƒƒãƒˆã®ã¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŸã‚ã€ã™ã¹ã¦ã®å¹´ã®ä¾‹ã‚’è¡¨ç¤ºã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

# æ¼”ç¿’2:ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ å†…ã®ãƒ‡ãƒ¼ã‚¿ã®æ¢ç´¢

ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ã€ãã“ã«å«ã¾ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å‡¦ç†ã€ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã€ãã®ä»–ã®æ“ä½œã«ä½¿ç”¨ã§ãã‚‹ã•ã¾ã–ã¾ãªé–¢æ•°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ã‚¿ã‚¹ã‚¯1:ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹

1.  ã‚»ãƒ«å‡ºåŠ›ã®ä¸‹ã«ã‚ã‚‹**+Code**ã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«æ–°ã—ã„ã‚³ãƒ¼ãƒ‰
    ã‚»ãƒ«ã‚’è¿½åŠ ã—ã€ãã“ã«æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

> customers = df\['CustomerName', 'Email'\]
>
> print(customers.count())
>
> print(customers.distinct().count())
>
> display(customers.distinct())
>
> ![](./media/image38.png)

2.  æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã€çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

    - ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¯¾ã—ã¦æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€çµæœã¯æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆã“ã®å ´åˆã¯æ–°ã—ã„**é¡§å®¢ï¼‰**ã«ãªã‚Šã¾ã™**ã€‚**Â ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¯ã€
      **DF**ã‹ã‚‰ç‰¹å®šã®åˆ—ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã‚’é¸æŠã—ã¦ä½œæˆã•ã‚Œã¾ã™ã€‚Â ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰

    - ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ã¯ã€å«ã¾ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’è¦ç´„ã—ãŸã‚Šãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ãŸã‚Šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹**count**ã‚„**distinct**ãªã©ã®é–¢æ•°ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

    - dataframe\['Field1', 'Field2',
      ...\]Â æ§‹æ–‡ã¯ã€åˆ—ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹ãŸã‚ã®ç°¡æ½”ãªæ–¹æ³•ã§ã™ã€‚selectãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ä½¿ç”¨ã§ãã‚‹ãŸã‚ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã®æœ€åˆã®è¡Œã¯customers
      = df.select (" CustomerName ", "Email")ã¨è¨˜è¿°ã§ãã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image39.png)

3.  ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã€**ã‚»ãƒ«å†…ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’**æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¦ã€æ¬¡ã®ã‚ˆã†ã«**â–·ã‚»ãƒ«å®Ÿè¡Œ**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> CodeCopy
>
> customers = df.select("CustomerName",
> "Email").where(df\['Item'\]=='Road-250 Red, 52 ')
>
> print(customers.count())
>
> print(customers.distinct().count())
>
> display(customers.distinct())

4.  ä¿®æ­£ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’**å®Ÿè¡Œ**ã—ã¦ã€**Road-250 Red**,
    52ã‚’è³¼å…¥ã—ãŸé¡§å®¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚è¤‡æ•°ã®é–¢æ•°ã‚’ã€Œ**é€£é–**ã€ã—ã¦ã€ã‚ã‚‹é–¢æ•°ã®å‡ºåŠ›ã‚’æ¬¡ã®é–¢æ•°ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨ã§ãã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã®å ´åˆã€**select**ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ãŒã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã‚’é©ç”¨ã™ã‚‹**where**ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚½ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¨ãªã‚Šã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image40.png)

## ã‚¿ã‚¹ã‚¯2:ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã—ã¦ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹

1.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> CodeCopy
>
> productSales = df.select("Item", "Quantity").groupBy("Item").sum()
>
> display(productSales)
>
> ![](./media/image41.png)

2.  çµæœã«ã¯ã€å•†å“ã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã•ã‚ŒãŸæ³¨æ–‡æ•°é‡ã®åˆè¨ˆãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚**groupBy**ãƒ¡ã‚½ãƒƒãƒ‰ã¯è¡Œã‚’*Itemã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—*ã€ãã®å¾Œã«ç¶šã**sum**é›†è¨ˆé–¢æ•°ã¯æ®‹ã‚Šã®æ•°å€¤åˆ—ï¼ˆã“ã®å ´åˆã¯Quantityï¼‰ã«é©ç”¨ã•ã‚Œ*ã¾ã™*ã€‚

3.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image42.png)

> **CodeCopy**
>
> from pyspark.sql.functions import \*
>
> yearlySales =
> df.select(year("OrderDate").alias("Year")).groupBy("Year").count().orderBy("Year")
>
> display(yearlySales)
>
> ![](./media/image43.png)

4.  çµæœã«ã¯å¹´é–“ã®è²©å£²æ³¨æ–‡æ•°ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚**select**ãƒ¡ã‚½ãƒƒãƒ‰ã«ã¯ã€OrderDateãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å¹´è¦ç´ ã‚’æŠ½å‡ºã™ã‚‹SQL
    **year**é–¢æ•°ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„**ï¼ˆ***ãã®*ãŸã‚ã€**ã‚³ãƒ¼ãƒ‰**ã«ã¯Spark
    SQLãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰é–¢æ•°ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã®**import**æ–‡ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚æ¬¡ã«ã€
    **alias**ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€æŠ½å‡ºã•ã‚ŒãŸå¹´å€¤ã«åˆ—åã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã¯å°å‡ºã•ã‚ŒãŸ*Year*åˆ—ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã•ã‚Œã€å„ã‚°ãƒ«ãƒ¼ãƒ—ã®è¡Œæ•°ãŒè¨ˆç®—ã•ã‚ŒãŸå¾Œã€æœ€å¾Œã«**orderBy**ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦çµæœã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä¸¦ã¹æ›¿ãˆã¾ã™ã€‚

# æ¼”ç¿’3: Sparkã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›ã™ã‚‹

ãƒ‡ãƒ¼ã‚¿
ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ä¸€èˆ¬çš„ãªã‚¿ã‚¹ã‚¯ã¯ã€ç‰¹å®šã®å½¢å¼ã¾ãŸã¯æ§‹é€ ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã€ãã‚Œã‚’ã•ã‚‰ã«ä¸‹æµã®å‡¦ç†ã‚„åˆ†æã®ãŸã‚ã«å¤‰æ›ã™ã‚‹ã“ã¨ã§ã™ã€‚

## ã‚¿ã‚¹ã‚¯ 1:ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¨é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã™ã‚‹

1.  +Codeã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

**CodeCopy**

> from pyspark.sql.functions import \*
>
> \## Create Year and Month columns
>
> transformed_df = df.withColumn("Year",
> year(col("OrderDate"))).withColumn("Month", month(col("OrderDate")))
>
> \# Create the new FirstName and LastName fields
>
> transformed_df = transformed_df.withColumn("FirstName",
> split(col("CustomerName"), " ").getItem(0)).withColumn("LastName",
> split(col("CustomerName"), " ").getItem(1))
>
> \# Filter and reorder columns
>
> transformed_df = transformed_df\["SalesOrderNumber",
> "SalesOrderLineNumber", "OrderDate", "Year", "Month", "FirstName",
> "LastName", "Email", "Item", "Quantity", "UnitPrice", "Tax"\]
>
> \# Display the first five orders
>
> display(transformed_df.limit(5))
>
> ![](./media/image44.png)

2.  ã‚³ãƒ¼ãƒ‰**ã‚’å®Ÿè¡Œã—ã¦ã€**æ¬¡ã®å¤‰æ›ã‚’å«ã‚€å…ƒã®æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚

    - **OrderDateåˆ—**ã«åŸºã¥ã„ã¦ã€ **Yearåˆ—**ã¨**Monthåˆ—**ã‚’è¿½åŠ ã—ã¾ã™ã€‚

    - **CustomerNameåˆ—**ã«åŸºã¥ã„ã¦**FirstNameåˆ—**ã¨**LastNameåˆ—**ã‚’è¿½åŠ ã—ã¾ã™ã€‚

    - åˆ—ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã—ã¦ä¸¦ã¹æ›¿ãˆã€ **CustomerName**åˆ—ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

> ![](./media/image45.png)

3.  å‡ºåŠ›ã‚’ç¢ºèªã—ã€ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ãŒè¡Œã‚ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image46.png)

Spark SQL
ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å…¨æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦ã€è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€åˆ—ã®æ´¾ç”Ÿã€å‰Šé™¤ã€åå‰å¤‰æ›´ã€ãã®ä»–ã®å¿…è¦ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›´ã®é©ç”¨ãªã©ã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã§ãã¾ã™ã€‚

**ãƒ’ãƒ³ãƒˆ**: Dataframeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€
[*Sparkãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„*](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/dataframe.html)ã€‚

## ã‚¿ã‚¹ã‚¯2: å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹

1.  ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€æ–°ã—ã„ã‚»ãƒ«ã‚’è¿½åŠ ã—ã€å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’Parquetå½¢å¼ã§ä¿å­˜ã—ã¾ã™ï¼ˆæ—¢ã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ä¸Šæ›¸ãã—ã¾ã™ï¼‰ã€‚ã‚»ãƒ«**ã‚’å®Ÿè¡Œã—**ã€ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã¡ã¾ã™ã€‚

> CodeCopy
>
> transformed_df.write.mode("overwrite").parquet('Files/transformed_data/orders')
>
> print ("Transformed data saved!")
>
> **æ³¨**ï¼šä¸€èˆ¬çš„ã«ã€ã•ã‚‰ãªã‚‹åˆ†æã‚„åˆ†æã‚¹ãƒˆã‚¢ã¸ã®å–ã‚Šè¾¼ã¿ã«ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€
> *Parquetå½¢å¼ãŒå¥½ã¾ã‚Œã¾ã™ã€‚Parquetã¯éå¸¸ã«åŠ¹ç‡çš„ãªå½¢å¼ã§ã€ã»ã¨ã‚“ã©ã®*å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿åˆ†æã‚·ã‚¹ãƒ†ãƒ ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚å®Ÿéš›ã€ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã®è¦ä»¶ãŒã€åˆ¥ã®å½¢å¼ï¼ˆCSVãªã©ï¼‰ã‹ã‚‰Parquetå½¢å¼ã¸ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã ã‘ã§ã‚ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚
>
> ![](./media/image47.png)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image48.png)

2.  æ¬¡ã«ã€å·¦å´ã®**Lakehouse explorerãƒ©ãƒ¼ãƒšã‚¤ãƒ³ã§ã€ \[Files\]ãƒãƒ¼ãƒ‰ã® \[
    ...\]**ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®**\[Refresh\]**ã‚’é¸æŠã—ã¾ã™ã€‚

> ![](./media/image49.png)

3.  **transformed_data**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€
    **orders**ã¨ã„ã†åå‰ã®æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«ã¯ã€1
    ã¤ä»¥ä¸Šã®**Parquet ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™**ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image50.png)

4.  **+ Code**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ **transformed_data -\>
    orders**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã® parquet
    ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚

> **CodeCopy**
>
> orders_df =
> spark.read.format("parquet").load("Files/transformed_data/orders")
>
> display(orders_df)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image51.png)

5.  ã‚»ãƒ«**ã‚’å®Ÿè¡Œ**ã—ã€çµæœã« parquet
    ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã¾ã‚ŒãŸæ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image52.png)

## ã‚¿ã‚¹ã‚¯3: ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹

1.  æ–°ã—ã„ã‚»ãƒ«ã‚’è¿½åŠ ã—ã€
    **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ãŒä¿å­˜ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãŒ**å¹´**ã¨**æœˆ**ã§åˆ†å‰²ã•ã‚Œã¾ã™ã€‚ã‚»ãƒ«ã‚’**å®Ÿè¡Œã—**ã€ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã™ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã¡ã¾ã™ã€‚

> CodeCopy
>
> orders_df.write.partitionBy("Year","Month").mode("overwrite").parquet("Files/partitioned_data")
>
> print ("Transformed data saved!")
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image53.png)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image54.png)

2.  æ¬¡ã«ã€å·¦å´ã®**Lakehouse explorer**ãƒšã‚¤ãƒ³ã§ã€ **\[Files\]**ãƒãƒ¼ãƒ‰ã®
    **\[ ...\]**ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã® \[**Refresh**\]ã‚’é¸æŠã—ã¾ã™**ã€‚**

![](./media/image55.png)

3.  **ã€Œpartitioned_ordersã€ãƒ•ã‚©ãƒ«ãƒ€**ã‚’å±•é–‹ã—ã€ **ã€ŒYear=
    *xxxxã€***ã¨ã„ã†åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€éšå±¤æ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚å„ãƒ•ã‚©ãƒ«ãƒ€ã«ã¯ã€Œ
    **Month=
    *xxxxã€ã¨ã„ã†åå‰ã®ãƒ•ã‚©ãƒ«ãƒ€ãŒå«ã¾ã‚Œã¦ã„ã¾ã™***ã€‚å„æœˆãƒ•ã‚©ãƒ«ãƒ€ã«ã¯ã€ãã®æœˆã®æ³¨æ–‡æƒ…å ±ã‚’å«ã‚€parquetãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image56.png)

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image57.png)

> ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã¯ã€å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã†éš›ã«ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æœ€é©åŒ–ã™ã‚‹ãŸã‚ã®ä¸€èˆ¬çš„ãªæ–¹æ³•ã§ã™ã€‚ã“ã®æ‰‹æ³•ã«ã‚ˆã‚Šã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå¤§å¹…ã«å‘ä¸Šã—ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚

4.  æ–°ã—ã„ã‚»ãƒ«ã‚’è¿½åŠ ã—ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€**+Code**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€
    **orders.parquetãƒ•ã‚¡ã‚¤ãƒ«**ã‹ã‚‰æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚

> CodeCopy
>
> orders_2021_df =
> spark.read.format("parquet").load("Files/partitioned_data/Year=2021/Month=\*")
>
> display(orders_2021_df)

5.  ã‚»ãƒ«ã‚’**å®Ÿè¡Œ**ã—ã€çµæœã« 2021
    å¹´ã®å£²ä¸Šã®æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ãƒ‘ã‚¹ã§æŒ‡å®šã•ã‚ŒãŸãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ—
    (**å¹´**ã¨**æœˆ**)
    ã¯ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å«ã¾ã‚Œã¦ã„ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image58.png)

# **æ¼”ç¿’3: ãƒ†ãƒ¼ãƒ–ãƒ«ã¨SQLã®æ“ä½œ**

ã”è¦§ã®ã¨ãŠã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’éå¸¸ã«åŠ¹ç‡çš„ã«ã‚¯ã‚¨ãƒªãŠã‚ˆã³åˆ†æã§ãã¾ã™ã€‚ã—ã‹ã—ã€å¤šãã®ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒŠãƒªã‚¹ãƒˆã¯ã€SQLæ§‹æ–‡ã‚’ä½¿ç”¨ã—ã¦ã‚¯ã‚¨ãƒªã§ãã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã§ã®ä½œæ¥­ã«æ…£ã‚Œã¦ã„ã¾ã™ã€‚Sparkã¯ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®šç¾©ã§ãã‚‹ãƒ¡ã‚¿ã‚¹ãƒˆã‚¢ã‚’æä¾›ã—ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æä¾›ã™ã‚‹Spark
SQLãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ãƒ¡ã‚¿ã‚¹ãƒˆã‚¢å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹ãŸã‚ã®SQLã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®ä½¿ç”¨ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚Sparkã®ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ã‚¯ã®æŸ”è»Ÿæ€§ã¨ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹ã®æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒãŠã‚ˆã³SQLãƒ™ãƒ¼ã‚¹ã®ã‚¯ã‚¨ãƒªã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚ŒãŒã€Œãƒ‡ãƒ¼ã‚¿ãƒ¬ã‚¤ã‚¯ãƒã‚¦ã‚¹ã€ã¨å‘¼ã°ã‚Œã‚‹ç†ç”±ã§ã™ã€‚

ã‚¿ã‚¹ã‚¯1ï¼šãƒãƒãƒ¼ã‚¸ãƒ‰ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

## ã‚¿ã‚¹ã‚¯1: ç®¡ç†å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹

Sparkãƒ¡ã‚¿ã‚¹ãƒˆã‚¢å†…ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€ãƒ‡ãƒ¼ã‚¿
ãƒ¬ã‚¤ã‚¯å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã™ã‚‹ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«æŠ½è±¡åŒ–ã§ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã¯*ç®¡ç†å¯¾è±¡*(ã“ã®å ´åˆã€ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ¡ã‚¿ã‚¹ãƒˆã‚¢ã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¾ã™)
ã¾ãŸã¯*å¤–éƒ¨(ã“ã®å ´åˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ã¯*ãƒ¡ã‚¿ã‚¹ãƒˆã‚¢ã¨ã¯ç‹¬ç«‹ã—ã¦ç®¡ç†ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿
ãƒ¬ã‚¤ã‚¯å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’å‚ç…§ã—ã¾ã™) ã«ãªã‚Šã¾ã™ã€‚

1.  æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã€
    ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®**+Code**ã‚»ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è²©å£²æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ãŒ**salesorders**ã¨ã„ã†åå‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦ä¿å­˜ã•ã‚Œã¾ã™ã€‚

> CodeCopy
>
> \# Create a new table
>
> df.write.format("delta").saveAsTable("salesorders")
>
> \# Get the table description
>
> spark.sql("DESCRIBE EXTENDED salesorders").show(truncate=False)

**æ³¨**ï¼šã“ã®ä¾‹ã«ã¯ã„ãã¤ã‹æ³¨ç›®ã™ã¹ãç‚¹ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãšã€æ˜ç¤ºçš„ãªãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ãƒ¡ã‚¿ã‚¹ãƒˆã‚¢ã«ã‚ˆã£ã¦ç®¡ç†ã•ã‚Œã¾ã™ã€‚æ¬¡ã«ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã¯**ãƒ‡ãƒ«ã‚¿**å½¢å¼ã§ä¿å­˜ã•ã‚Œã¾ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã¯è¤‡æ•°ã®ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ï¼ˆCSVã€Parquetã€Avroãªã©ï¼‰ã«åŸºã¥ã„ã¦ä½œæˆã§ãã¾ã™ãŒã€*ãƒ‡ãƒ«ã‚¿ãƒ¬ã‚¤ã‚¯ã¯ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚µãƒãƒ¼ãƒˆã€è¡Œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã€ãã®ä»–ã®ä¾¿åˆ©ãªæ©Ÿèƒ½ã‚’å«ã‚€*ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ©Ÿèƒ½ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ ã™ã‚‹Sparkãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã§ã™ã€‚Fabricã®ãƒ‡ãƒ¼ã‚¿Lakehouseã§ã¯ã€ãƒ‡ãƒ«ã‚¿å½¢å¼ã§ã®ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚

2.  ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’**å®Ÿè¡Œ**ã—ã€æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã®å®šç¾©ã‚’ç¤ºã™å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image59.png)

3.  **Lakehouse
    explorer**ãƒšã‚¤ãƒ³ã§ã€**Tables**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®**â€¦**ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ã€
    **\[Refresh\]** ã‚’é¸æŠã—ã¾ã™ã€‚

![](./media/image60.png)

4.  æ¬¡ã«ã€ **\[Tables\]**ãƒãƒ¼ãƒ‰ã‚’å±•é–‹ã—ã€
    **salesorders**ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image61.png)

5.  **salesordersãƒ†ãƒ¼ãƒ–ãƒ«ã®**æ¨ªã«ãƒã‚¦ã‚¹ã‚’ç§»å‹•ã—ã€æ°´å¹³ã®çœç•¥è¨˜å·ï¼ˆâ€¦ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
    **ã€ŒLoad dataã€**ã«ç§»å‹•ã—ã€ **ã€ŒSparkã€ã‚’é¸æŠã—ã¾ã™**ã€‚

![A screenshot of a computer Description automatically
generated](./media/image62.png)

6.  **â–·Run cellãƒœã‚¿ãƒ³**ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€Spark SQL
    ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ **salesorderãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã™ã‚‹
    SQLã‚¯ã‚¨ãƒªã‚’**PySparkã‚³ãƒ¼ãƒ‰ã«åŸ‹ã‚è¾¼ã¿ã€ã‚¯ã‚¨ãƒªã®çµæœã‚’ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«èª­ã¿è¾¼ã¿ã¾ã™ã€‚

> CodeCopy
>
> df = spark.sql("SELECT \* FROM \[your_lakehouse\].salesorders LIMIT
> 1000")
>
> display(df)

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image63.png)

## ã‚¿ã‚¹ã‚¯2: å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã™ã‚‹

Lakehouseã®ãƒ¡ã‚¿ã‚¹ãƒˆã‚¢ã§ã‚¹ã‚­ãƒ¼ãƒ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå®šç¾©ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿
ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤–éƒ¨ã®å ´æ‰€ã«ä¿å­˜ã•ã‚Œã‚‹*å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«*ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

1.  æœ€åˆã®ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‹ã‚‰è¿”ã•ã‚ŒãŸçµæœã®ä¸‹ã«ã‚ã‚‹**ã€Œ+Codeã€**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ï¼ˆã¾ã ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆï¼‰ã€‚æ–°ã—ã„ã‚»ãƒ«ã«æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

CodeCopy

> df.write.format("delta").saveAsTable("external_salesorder",
> path="\<abfs_path\>/external_salesorder")

![A screenshot of a computer Description automatically
generated](./media/image64.png)

2.  **Lakehouse explorer**ãƒšã‚¤ãƒ³ã® \[**Files**\] ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã® \[ â€¦\]
    ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§**ã€ãƒ¡ãƒ¢**å¸³ã§ \[**Copy ABFS path**\] ã‚’é¸æŠã—ã¾ã™**ã€‚**

> Lakehouseã®OneLakeã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å†…ã®**Files**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã¸ã®å®Œå…¨ä¿®é£¾ãƒ‘ã‚¹ã§ã™ã€‚æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

abfss://dp_Fabric29@onelake.dfs.fabric.microsoft.com/Fabric_lakehouse.Lakehouse/Files/external_salesorder

![A screenshot of a computer Description automatically
generated](./media/image65.png)

3.  ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã«ç§»å‹•ã—ã€
    **\<abfs_path\>ã‚’**ãƒ¡ãƒ¢å¸³ã«ã‚³ãƒ”ãƒ¼ã—ãŸ**ãƒ‘ã‚¹**ã«ç½®ãæ›ãˆã¾ã™**ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿**ãƒ•ãƒ¬ãƒ¼ãƒ ãŒå¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦ä¿å­˜ã•ã‚Œã€
    **Files**ãƒ•ã‚©ãƒ«ãƒ€å†…ã®**external_salesorder**ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚å®Œå…¨ãªãƒ‘ã‚¹ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

abfss://dp_Fabric29@onelake.dfs.fabric.microsoft.com/Fabric_lakehouse.Lakehouse/Files/external_salesorder

4.  ã‚»ãƒ«ã®å·¦å´ã«ã‚ã‚‹**â–· (Run cell)**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image66.png)

5.  **Lakehouse
    explorer**ãƒšã‚¤ãƒ³ã®**Tables**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã®**â€¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼**ã§ã€\[**Refresh\]**ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image67.png)

6.  æ¬¡ã«ã€**Tables**ãƒãƒ¼ãƒ‰ã‚’å±•é–‹ã—ã€
    **external_salesorder**ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image68.png)

7.  **Lakehouse explorer**ãƒšã‚¤ãƒ³ã® **Files** ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã® â€¦ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ã€
    **\[Refresh\]**ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image69.png)

8.  æ¬¡ã«ã€ **\[Files\]**ãƒãƒ¼ãƒ‰ã‚’å±•é–‹ã—ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ãƒ¼ã‚¿
    ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã«**external_salesorder**ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image70.png)

## ã‚¿ã‚¹ã‚¯ 3: ç®¡ç†å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã¨å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ¯”è¼ƒã™ã‚‹

ç®¡ç†å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã¨å¤–éƒ¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®é•ã„ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

1.  ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‹ã‚‰è¿”ã•ã‚ŒãŸçµæœã®ä¸‹ã«ã‚ã‚‹**ã€Œ+Codeã€**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã«ã‚³ãƒ”ãƒ¼ã—ã€ã‚»ãƒ«ã®å·¦å´ã«ã‚ã‚‹**ã€Œâ–·ã€
    (*Run cell*)**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚

> SqlCopy
>
> %%sql
>
> DESCRIBE FORMATTED salesorders;
>
> ![](./media/image71.png)

2.  çµæœã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®**Location**ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç¢ºèªã—ã¾ã™**ã€‚ã“ã‚Œã¯ã€
    /Tables/
    salesorders**ã§çµ‚ã‚ã‚‹Lakehouseã®OneLakeã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¸ã®ãƒ‘ã‚¹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™(å®Œå…¨ãªãƒ‘ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€**Data
    type**ã®åˆ—ã‚’åºƒã’ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™)ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image72.png)

3.  **DESCRIBE**ã‚³ãƒãƒ³ãƒ‰ã‚’å¤‰æ›´ã—ã¦ã€
    **external_saleorder**ãƒ†ãƒ¼ãƒ–ãƒ«ã®è©³ç´°ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

4.  ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‹ã‚‰è¿”ã•ã‚ŒãŸçµæœã®ä¸‹ã«ã‚ã‚‹**ã€Œ+Codeã€**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã€ã‚»ãƒ«ã®å·¦å´ã«ã‚ã‚‹**ã€Œâ–·
    ï¼ˆ*Run cell*ï¼‰ã€**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚

> SqlCopy
>
> %%sql
>
> DESCRIBE FORMATTED external_salesorder ;

5.  çµæœã§ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã®**Location**ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã¯ã€
    **/Files/external_saleorder**ã§çµ‚ã‚ã‚‹Lakehouseã® **OneLake**
    ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¸ã®ãƒ‘ã‚¹ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
    **(**å®Œå…¨ãªãƒ‘ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€**Data
    type**ã‚’åºƒã’ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™)ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image73.png)

## ã‚¿ã‚¹ã‚¯4: ã‚»ãƒ«å†…ã§SQLã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹

PySpark ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€ã‚»ãƒ«ã« SQL
ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’åŸ‹ã‚è¾¼ã‚€ã“ã¨ãŒã§ãã‚‹ã¨ä¾¿åˆ©ã§ã™ãŒã€ãƒ‡ãƒ¼ã‚¿ ã‚¢ãƒŠãƒªã‚¹ãƒˆã¯
SQL ã§ç›´æ¥ä½œæ¥­ã—ãŸã„å ´åˆãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚

1.  **ã€Œ+Code**ã€ã‚»ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ **ã€Œâ–·Run
    cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚ä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

    - ã‚»ãƒ«ã®å…ˆé ­ã«ã‚ã‚‹ %%sql è¡Œ (ãƒã‚¸ãƒƒã‚¯
      ã¨å‘¼ã°ã‚Œã¾ã™)ã¯*ã€*ã“ã®ã‚»ãƒ«å†…ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã« PySpark
      ã§ã¯ãªã Spark SQL
      è¨€èªãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚

    - SQL ã‚³ãƒ¼ãƒ‰ã¯ã€ä»¥å‰ã«ä½œæˆã—ãŸ**salesorders**ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã—ã¾ã™ã€‚

    - SQLã‚¯ã‚¨ãƒªã®å‡ºåŠ›ã¯ã€ã‚»ãƒ«ã®ä¸‹ã«çµæœã¨ã—ã¦è‡ªå‹•çš„ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

> SqlCopy
>
> %%sql
>
> SELECT YEAR(OrderDate) AS OrderYear,
>
> SUM((UnitPrice \* Quantity) + Tax) AS GrossRevenue
>
> FROM salesorders
>
> GROUP BY YEAR(OrderDate)
>
> ORDER BY OrderYear;

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image74.png)

**æ³¨**: Spark SQL ã¨ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ [*Spark SQL
ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„*](https://spark.apache.org/docs/2.2.0/sql-programming-guide.html)ã€‚

# æ¼”ç¿’4: Sparkã§ãƒ‡ãƒ¼ã‚¿ã‚’è¦–è¦šåŒ–ã™ã‚‹

è«ºã«ã‚‚ã‚ã‚‹ã‚ˆã†ã«ã€ä¸€æšã®å†™çœŸã¯åƒã®è¨€è‘‰ã«å€¤ã—ã€ã‚°ãƒ©ãƒ•ã¯åƒè¡Œã®ãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šã‚‚å„ªã‚Œã¦ã„ã‚‹å ´åˆãŒå¤šã„ã§ã™ã€‚Fabricã®ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¾ãŸã¯Spark
SQLã‚¯ã‚¨ãƒªã‹ã‚‰è¡¨ç¤ºã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ç”¨ã®ã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ãŒã€åŒ…æ‹¬çš„ãªã‚°ãƒ©ãƒ•ä½œæˆã«ã¯è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãŸã ã—ã€
**matplotlib**ã‚„**seaborn**ãªã©ã®Pythonã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚Œã°ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ å†…ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã§ãã¾ã™ã€‚

## ã‚¿ã‚¹ã‚¯1: çµæœã‚’ã‚°ãƒ©ãƒ•ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹

1.  **ã€Œ+ Code**ã€ã‚»ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ **ã€Œâ–·Run
    cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€å…ˆã»ã©ä½œæˆã—ãŸ**salesorders**ãƒ“ãƒ¥ãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

> SqlCopy
>
> %%sql
>
> SELECT \* FROM salesorders

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image75.png)

2.  ã‚»ãƒ«ã®ä¸‹ã®çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€\[**View\]**ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’**\[Table\]**ã‹ã‚‰**\[+New
    chart\]**ã«å¤‰æ›´ã—ã¾ã™ã€‚

![](./media/image76.png)

3.  ãƒãƒ£ãƒ¼ãƒˆã®å³ä¸Šã«ã‚ã‚‹**ã€ŒStart
    editingã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ãƒãƒ£ãƒ¼ãƒˆã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã—ã€
    **ã€ŒApplyã€**ã‚’é¸æŠã—ã¾ã™ã€‚

    - **Chart type**: Bar chart

    - **Key**: Item

    - **Values**: Quantity

    - **Series Group**:Â *leave blank*

    - **Aggregation**: Sum

    - **Stacked**:Â *Unselected*

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image77.png)

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image78.png)

4.  ãƒãƒ£ãƒ¼ãƒˆãŒæ¬¡ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™

> ![](./media/image79.png)

## ã‚¿ã‚¹ã‚¯2: matplotlibã‚’ä½¿ã„å§‹ã‚ã‚‹

1.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’**å®Ÿè¡Œ**ã™ã‚‹ã¨ã€å¹´é–“åç›Šã‚’å«ã‚€Sparkãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ãŒè¿”ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

> CodeCopy
>
> sqlQuery = "SELECT CAST(YEAR(OrderDate) AS CHAR(4)) AS OrderYear, \\
>
> SUM((UnitPrice \* Quantity) + Tax) AS GrossRevenue \\
>
> FROM salesorders \\
>
> GROUP BY CAST(YEAR(OrderDate) AS CHAR(4)) \\
>
> ORDER BY OrderYear"
>
> df_spark = spark.sql(sqlQuery)
>
> df_spark.show()
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image80.png)

2.  ãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•ã¨ã—ã¦è¦–è¦šåŒ–ã™ã‚‹ãŸã‚ã«ã€ã¾ãšã¯**matplotlib**
    Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ä»–ã®å¤šãã®ãƒ—ãƒ­ãƒƒãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ™ãƒ¼ã‚¹ã¨ãªã£ã¦ã„ã‚‹ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚Šã€ã‚°ãƒ©ãƒ•ä½œæˆã«ãŠã„ã¦éå¸¸ã«æŸ”è»Ÿãªæ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

3.  **+ Code**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

**CodeCopy**

> from matplotlib import pyplot as plt
>
> \# matplotlib requires a Pandas dataframe, not a Spark one
>
> df_sales = df_spark.toPandas()
>
> \# Create a bar plot of revenue by year
>
> plt.bar(x=df_sales\['OrderYear'\], height=df_sales\['GrossRevenue'\])
>
> \# Display the plot
>
> plt.show()

![A screenshot of a computer Description automatically
generated](./media/image81.png)

5.  **ã€ŒRun
    cellã€ãƒœã‚¿ãƒ³**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚çµæœã¯ã€å„å¹´ã®ç·å£²ä¸Šé«˜ã‚’ç¤ºã™ç¸¦æ£’ã‚°ãƒ©ãƒ•ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã®ä»¥ä¸‹ã®ç‰¹å¾´ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

    - **matplotlib**ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯*Pandasãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ *ãŒå¿…è¦ãªã®ã§ã€
      Spark SQL
      ã‚¯ã‚¨ãƒªã«ã‚ˆã£ã¦è¿”ã•ã‚Œã‚‹*Sparkãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ã“ã®å½¢å¼ã«*å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

    - **matplotlib**ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸­æ ¸ã¯**pyplot**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ã“ã‚Œã¯ã»ã¨ã‚“ã©ã®ãƒ—ãƒ­ãƒƒãƒˆæ©Ÿèƒ½ã®åŸºç›¤ã¨ãªã‚Šã¾ã™ã€‚

    - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§ã‚‚ä½¿ãˆã‚‹ãƒãƒ£ãƒ¼ãƒˆãŒå‡ºæ¥ä¸ŠãŒã‚Šã¾ã™ãŒã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã®ä½™åœ°ã¯ã‹ãªã‚Šã‚ã‚Šã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image82.png)

6.  æ¬¡ã®ã‚ˆã†ã«ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦ãƒãƒ£ãƒ¼ãƒˆã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã€**ã‚»ãƒ«**å†…ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¦ã€
    **â–·Run cell**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‡ºåŠ›ã‚’ç¢ºèªã—ã¾ã™ã€‚

> CodeCopy
>
> from matplotlib import pyplot as plt
>
> \# Clear the plot area
>
> plt.clf()
>
> \# Create a bar plot of revenue by year
>
> plt.bar(x=df_sales\['OrderYear'\], height=df_sales\['GrossRevenue'\],
> color='orange')
>
> \# Customize the chart
>
> plt.title('Revenue by Year')
>
> plt.xlabel('Year')
>
> plt.ylabel('Revenue')
>
> plt.grid(color='#95a5a6', linestyle='--', linewidth=2, axis='y',
> alpha=0.7)
>
> plt.xticks(rotation=45)
>
> \# Show the figure
>
> plt.show()
>
> ![A screenshot of a computer program AI-generated content may be
> incorrect.](./media/image83.png)
>
> ![A graph with orange bars AI-generated content may be
> incorrect.](./media/image84.png)

7.  ãƒãƒ£ãƒ¼ãƒˆã«å°‘ã—æƒ…å ±ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚ãƒ—ãƒ­ãƒƒãƒˆã¯æŠ€è¡“çš„ã«ã¯**Figure**ã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚å‰ã®ä¾‹ã§ã¯ã€
    Figure
    ã¯æš—é»™çš„ã«ä½œæˆã•ã‚Œã¦ã„ã¾ã—ãŸãŒã€æ˜ç¤ºçš„ã«ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

8.  æ¬¡ã®ã‚ˆã†ã«ã‚°ãƒ©ãƒ•ã‚’ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã€**ã‚»ãƒ«**å†…ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¾ã™ã€‚

> CodeCopy
>
> from matplotlib import pyplot as plt
>
> \# Clear the plot area
>
> plt.clf()
>
> \# Create a Figure
>
> fig = plt.figure(figsize=(8,3))
>
> \# Create a bar plot of revenue by year
>
> plt.bar(x=df_sales\['OrderYear'\], height=df_sales\['GrossRevenue'\],
> color='orange')
>
> \# Customize the chart
>
> plt.title('Revenue by Year')
>
> plt.xlabel('Year')
>
> plt.ylabel('Revenue')
>
> plt.grid(color='#95a5a6', linestyle='--', linewidth=2, axis='y',
> alpha=0.7)
>
> plt.xticks(rotation=45)
>
> \# Show the figure
>
> plt.show()

9.  ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’**å†å®Ÿè¡Œ**ã—ã€çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚å›³ã¯ãƒ—ãƒ­ãƒƒãƒˆã®å½¢çŠ¶ã¨ã‚µã‚¤ã‚ºã‚’æ±ºå®šã—ã¾ã™ã€‚

> å›³ã«ã¯ã€ãã‚Œãã‚Œç‹¬è‡ªã®*è»¸ä¸Šã«è¤‡æ•°ã®ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™*ã€‚
>
> ![A screenshot of a computer program AI-generated content may be
> incorrect.](./media/image85.png)
>
> ![A screenshot of a graph AI-generated content may be
> incorrect.](./media/image86.png)

10. ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¦ã‚°ãƒ©ãƒ•ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚»ãƒ«ã‚’**å†å®Ÿè¡Œ**ã—ã€çµæœã‚’ç¢ºèªã—ã¾ã™ã€‚å›³ã«ã¯ã€ã‚³ãƒ¼ãƒ‰ã§æŒ‡å®šã—ãŸã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

> CodeCopy
>
> from matplotlib import pyplot as plt
>
> \# Clear the plot area
>
> plt.clf()
>
> \# Create a figure for 2 subplots (1 row, 2 columns)
>
> fig, ax = plt.subplots(1, 2, figsize = (10,4))
>
> \# Create a bar plot of revenue by year on the first axis
>
> ax\[0\].bar(x=df_sales\['OrderYear'\],
> height=df_sales\['GrossRevenue'\], color='orange')
>
> ax\[0\].set_title('Revenue by Year')
>
> \# Create a pie chart of yearly order counts on the second axis
>
> yearly_counts = df_sales\['OrderYear'\].value_counts()
>
> ax\[1\].pie(yearly_counts)
>
> ax\[1\].set_title('Orders per Year')
>
> ax\[1\].legend(yearly_counts.keys().tolist())
>
> \# Add a title to the Figure
>
> fig.suptitle('Sales Data')
>
> \# Show the figure
>
> plt.show()
>
> ![A screenshot of a computer program AI-generated content may be
> incorrect.](./media/image87.png)
>
> ![A screenshot of a computer screen AI-generated content may be
> incorrect.](./media/image88.png)

**æ³¨**: matplotlib ã‚’ä½¿ç”¨ã—ãŸãƒ—ãƒ­ãƒƒãƒˆã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ [*matplotlib
ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„*](https://matplotlib.org/)ã€‚

## ã‚¿ã‚¹ã‚¯3: seabornãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹

**matplotlib**
ã¯è¤‡æ•°ã®ç¨®é¡ã®è¤‡é›‘ãªã‚°ãƒ©ãƒ•ã‚’ä½œæˆã§ãã¾ã™ãŒã€æœ€é©ãªçµæœã‚’å¾—ã‚‹ã«ã¯è¤‡é›‘ãªã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€é•·å¹´ã«ã‚ãŸã‚Šã€matplotlib
ã‚’ãƒ™ãƒ¼ã‚¹ã«å¤šãã®æ–°ã—ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒé–‹ç™ºã•ã‚Œã€ãã®è¤‡é›‘ã•ã‚’æŠ½è±¡åŒ–ã—ã€æ©Ÿèƒ½ã‚’å¼·åŒ–ã—ã¦ãã¾ã—ãŸã€‚ãã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€ã¤ãŒ**seaborn**ã§ã™ã€‚

1.  **+Code**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚

CodeCopy

> import seaborn as sns
>
> \# Clear the plot area
>
> plt.clf()
>
> \# Create a bar chart
>
> ax = sns.barplot(x="OrderYear", y="GrossRevenue", data=df_sales)
>
> plt.show()

2.  ã‚³ãƒ¼ãƒ‰ã‚’**å®Ÿè¡Œ**ã—ã€seaborn
    ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦æ£’ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image89.png)

3.  ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«**å¤‰æ›´**ã—ã¦ãã ã•ã„**ã€‚**å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’**å®Ÿè¡Œ**ã™ã‚‹ã¨ã€seaborn
    ã«ã‚ˆã£ã¦ãƒ—ãƒ­ãƒƒãƒˆã«ä¸€è²«ã—ãŸã‚«ãƒ©ãƒ¼ãƒ†ãƒ¼ãƒã‚’è¨­å®šã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

> CodeCopy
>
> import seaborn as sns
>
> \# Clear the plot area
>
> plt.clf()
>
> \# Set the visual theme for seaborn
>
> sns.set_theme(style="whitegrid")
>
> \# Create a bar chart
>
> ax = sns.barplot(x="OrderYear", y="GrossRevenue", data=df_sales)
>
> plt.show()
>
> ![A screenshot of a graph AI-generated content may be
> incorrect.](./media/image90.png)

4.  ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«**ä¿®æ­£**ã—ã¦ãã ã•ã„**ã€‚**ä¿®æ­£ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’**å®Ÿè¡Œ**ã™ã‚‹ã¨ã€å¹´é–“åç›ŠãŒæŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

> CodeCopy
>
> import seaborn as sns
>
> \# Clear the plot area
>
> plt.clf()
>
> \# Create a bar chart
>
> ax = sns.lineplot(x="OrderYear", y="GrossRevenue", data=df_sales)
>
> plt.show()
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image91.png)

**æ³¨**: seaborn ã‚’ä½¿ç”¨ã—ãŸãƒ—ãƒ­ãƒƒãƒˆã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ [*seaborn
ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„*](https://seaborn.pydata.org/index.html)ã€‚

## ã‚¿ã‚¹ã‚¯4: ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã«ãƒ‡ãƒ«ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹

Delta Lakeã¯ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚Deltaãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€
Spark Structured Streaming
APIã‚’ä½¿ç”¨ã—ã¦ä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®*ã‚·ãƒ³ã‚¯*ã¾ãŸã¯*ã‚½ãƒ¼ã‚¹ã¨ã—ã¦ä½¿ç”¨ã§ãã¾ã™*ã€‚ã“ã®ä¾‹ã§ã¯ã€ãƒ¢ãƒã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆï¼ˆIoTï¼‰ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒŠãƒªã‚ªã«ãŠã„ã¦ã€Deltaãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã®ã‚·ãƒ³ã‚¯ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚

1.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

CodeCopy

> from notebookutils import mssparkutils
>
> from pyspark.sql.types import \*
>
> from pyspark.sql.functions import \*
>
> \# Create a folder
>
> inputPath = 'Files/data/'
>
> mssparkutils.fs.mkdirs(inputPath)
>
> \# Create a stream that reads data from the folder, using a JSON
> schema
>
> jsonSchema = StructType(\[
>
> StructField("device", StringType(), False),
>
> StructField("status", StringType(), False)
>
> \])
>
> iotstream =
> spark.readStream.schema(jsonSchema).option("maxFilesPerTrigger",
> 1).json(inputPath)
>
> \# Write some event data to the folder
>
> device_data = '''{"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"ok"}
>
> {"device":"Dev2","status":"error"}
>
> {"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"error"}
>
> {"device":"Dev2","status":"ok"}
>
> {"device":"Dev2","status":"error"}
>
> {"device":"Dev1","status":"ok"}'''
>
> mssparkutils.fs.put(inputPath + "data.txt", device_data, True)
>
> print("Source stream created...")
>
> ![A screenshot of a computer program AI-generated content may be
> incorrect.](./media/image92.png)
>
> ![A screenshot of a computer program AI-generated content may be
> incorrect.](./media/image93.png)

2.  ***ã‚½ãƒ¼ã‚¹ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒä½œæˆã•ã‚Œã¾ã—ãŸâ€¦ã€ã¨ã„ã†***ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚å®Ÿè¡Œã—ãŸã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚Šã€ä»®æƒ³IoTãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰ã®èª­ã¿å–ã‚Šãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«åŸºã¥ã„ã¦ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚

3.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

CodeCopy

> \# Write the stream to a delta table
>
> delta_stream_table_path = 'Tables/iotdevicedata'
>
> checkpointpath = 'Files/delta/checkpoint'
>
> deltastream =
> iotstream.writeStream.format("delta").option("checkpointLocation",
> checkpointpath).start(delta_stream_table_path)
>
> print("Streaming to delta sink...")
>
> ![](./media/image94.png)

4.  ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ«ã‚¿å½¢å¼ã§**iotdevicedata**ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã¯**Tables**ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã‚ã‚‹ãŸã‚ã€è‡ªå‹•çš„ã«ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¾ã™ã€‚ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ¨ªã«ã‚ã‚‹æ°´å¹³ã®çœç•¥è¨˜å·ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€
    **ã€ŒRefreshã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image95.png)

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image96.png)

5.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> SqlCopy
>
> %%sql
>
> SELECT \* FROM IotDeviceData;
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image97.png)

6.  ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒã‚¤ã‚¹
    ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã‚‹**IotDeviceDataãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ã‚¨ãƒªã—ã¾ã™ã€‚**

7.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> CodeCopy
>
> \# Add more data to the source stream
>
> more_data = '''{"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"ok"}
>
> {"device":"Dev1","status":"error"}
>
> {"device":"Dev2","status":"error"}
>
> {"device":"Dev1","status":"ok"}'''
>
> mssparkutils.fs.put(inputPath + "more-data.txt", more_data, True)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image98.png)

8.  ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚° ã‚½ãƒ¼ã‚¹ã«ã•ã‚‰ã«å¤šãã®ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹
    ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã¿ã¾ã™ã€‚

9.  **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> SqlCopy
>
> %%sql
>
> SELECT \* FROM IotDeviceData;
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image99.png)

10. ã“ã®ã‚³ãƒ¼ãƒ‰ã¯**IotDeviceData**ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å†åº¦ã‚¯ã‚¨ãƒªã—ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
    ã‚½ãƒ¼ã‚¹ã«è¿½åŠ ã•ã‚ŒãŸè¿½åŠ ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

11. **ã€Œ+Codeã€**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ã€
    **ã€ŒRun cellã€**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> CodeCopy
>
> deltastream.stop()
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image100.png)

12. ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’åœæ­¢ã—ã¾ã™ã€‚

## ã‚¿ã‚¹ã‚¯5: ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä¿å­˜ã—ã¦Sparkã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã™ã‚‹

ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œãŒå®Œäº†ã—ãŸã‚‰ã€ã‚ã‹ã‚Šã‚„ã™ã„åå‰ã§ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä¿å­˜ã—ã€Spark
ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã§ãã¾ã™ã€‚

1.  ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã§ã€âš™ï¸
    è¨­å®šã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®è¨­å®šã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image101.png)

2.  ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®**Nameã‚’ +++ Explore Sales Orders++
    +**ã«è¨­å®šã—ã€è¨­å®šãƒšã‚¤ãƒ³ã‚’é–‰ã˜ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image102.png)

3.  ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§**\[Stop session\]**ã‚’é¸æŠã—ã¦ã€Spark
    ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’çµ‚äº†ã—ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image103.png)

![A screenshot of a computer Description automatically
generated](./media/image104.png)

# æ¼”ç¿’ 5: Microsoft Fabric ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼(Gen2) ã‚’ä½œæˆã™ã‚‹

Microsoft Fabric ã§ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ (Gen2)
ãŒæ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã«æ¥ç¶šã—ã€Power Query Online
ã§å¤‰æ›ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ãã®å¾Œã€ãƒ‡ãƒ¼ã‚¿
ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€Lakehouseã‚„ãã®ä»–ã®åˆ†æã‚¹ãƒˆã‚¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã¿ã€Power
BI ãƒ¬ãƒãƒ¼ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®æ¼”ç¿’ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼ˆGen2ï¼‰ã®ã•ã¾ã–ã¾ãªè¦ç´ ã‚’ç´¹ä»‹ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€ä¼æ¥­ã«å­˜åœ¨ã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹è¤‡é›‘ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

## ã‚¿ã‚¹ã‚¯ 1: ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã‚€ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ (Gen2) ã‚’ä½œæˆã™ã‚‹

LakehouseãŒå®Œæˆã—ãŸã‚‰ã€ãã“ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®æ–¹æ³•ã®ä¸€ã¤ã¯ã€*æŠ½å‡ºã€å¤‰æ›ã€ãƒ­ãƒ¼ãƒ‰*ï¼ˆETLï¼‰ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã§ã™ã€‚

1.  æ¬¡ã«ã€å·¦å´ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
    ãƒšã‚¤ãƒ³ã§**Fabric_lakehouseã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚**

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image105.png)

2.  **Fabric_lakehouse ã®**ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã€ **ã€ŒGet
    dataã€**ã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³çŸ¢å°ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ **ã€ŒNew Dataflow
    Gen2ã€**ã‚’é¸æŠã—ã¾ã™**ã€‚**æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ç”¨ã® Power Query
    ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãŒé–‹ãã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image106.png)

5.  **\[New Dataflow Gen2\]**ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒœãƒƒã‚¯ã‚¹ã§ã€
    \[**Name\]ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**ã«**ã€Œ+++Gen2_Dataflow+++ã€**ã¨å…¥åŠ›ã—ã€
    **\[Create\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ Gen2
    ã‚’é–‹ãã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image107.png)

3.  **\[Home\] ã‚¿ãƒ–ã®\[Power Query\]**ãƒšã‚¤ãƒ³ã§ã€ **\[Import from a
    Text/CSV file\]**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image108.png)

4.  **Connect to data source**ãƒšã‚¤ãƒ³ã®**Connection settings**ã§ã€**Link
    to file (Preview)**ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã‚’é¸æŠã—ã¾ã™ã€‚

- **Link to file**:Â *Selected*

- **File path or
  URL**:Â +++https://raw.githubusercontent.com/MicrosoftLearning/dp-data/main/orders.csv+++

![](./media/image109.png)

5.  **\[Connect to data source\]**ãƒšã‚¤ãƒ³ã®**\[Connection credentials\]
    ã§ã€**æ¬¡ã®è©³ç´°ã‚’å…¥åŠ›ã—ã€ **\[Next\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

- **Connection**: Create new connection

- **data gateway**: (none)

- **Authentication kind**: Anonymous

> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image110.png)

6.  **Preview file data**ãƒšã‚¤ãƒ³ã§ã€ **\[Create\]**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ‡ãƒ¼ã‚¿
    ã‚½ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚![A screenshot of a computer Description
    automatically generated](./media/image111.png)

7.  **Power Query**ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿
    ã‚½ãƒ¼ã‚¹ã¨ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã™ã‚‹ãŸã‚ã®ã‚¯ã‚¨ãƒªæ‰‹é †ã®åˆæœŸã‚»ãƒƒãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image112.png)

8.  ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ãƒªãƒœãƒ³ã§**ã€ŒAdd columnã€**ã‚¿ãƒ–ã‚’é¸æŠã—ã¾ã™ã€‚æ¬¡ã«ã€
    **ã€ŒCustom columnã€**ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image113.png)Â 

9.  æ–°ã—ã„åˆ—åã‚’ +++ **MonthNo++ +ã«è¨­å®šã—**ã€ãƒ‡ãƒ¼ã‚¿å‹ã‚’**Whole
    Number**ã«è¨­å®šã—ã¦ã€æ¬¡ã®æ•°å¼ã‚’è¿½åŠ ã—ã¾ã™**:** +++ **Date.Month
    (\[OrderDate \])+ ++** ã€‚ ã€Œ**Custom column formulaã€**
    ã§**\[OK\]**ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image114.png)

10. ã‚«ã‚¹ã‚¿ãƒ åˆ—ã‚’è¿½åŠ ã™ã‚‹æ‰‹é †ãŒã‚¯ã‚¨ãƒªã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚çµæœã®åˆ—ã¯ãƒ‡ãƒ¼ã‚¿ãƒšã‚¤ãƒ³ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image115.png)

**ãƒ’ãƒ³ãƒˆ:**å³å´ã®ã€Œã‚¯ã‚¨ãƒªè¨­å®šã€ãƒšã‚¤ãƒ³ã§ã€ã€Œ**Applied
Stepsã€**ã«å„å¤‰æ›ã‚¹ãƒ†ãƒƒãƒ—ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ã”ç¢ºèªãã ã•ã„ã€‚ã¾ãŸã€ä¸‹éƒ¨ã«ã‚ã‚‹**ã€ŒDiagram
flowã€**ãƒœã‚¿ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ã€ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ã‚¹ãƒ†ãƒƒãƒ—ã¯ä¸Šä¸‹ã«ç§»å‹•ã—ãŸã‚Šã€æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸æŠã—ã¦ç·¨é›†ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã€å„ã‚¹ãƒ†ãƒƒãƒ—ã‚’é¸æŠã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
ãƒšã‚¤ãƒ³ã§å¤‰æ›ã®é©ç”¨ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ã‚¿ã‚¹ã‚¯ 2: Dataflow ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡å…ˆã‚’è¿½åŠ ã™ã‚‹

1.  **Power
    Query**ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ãƒªãƒœãƒ³ã§ã€ã€Œ**Homeã€**ã‚¿ãƒ–ã‚’é¸æŠã—ã¾ã™ã€‚æ¬¡ã«ã€ã€ŒD**ata
    destinationã€**ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§**ã€ŒLakehouseã€**ã‚’é¸æŠã—ã¾ã™ï¼ˆã¾ã é¸æŠã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã€‚

![](./media/image116.png)

![A screenshot of a computer Description automatically
generated](./media/image117.png)

**æ³¨:**ã“ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚°ãƒ¬ãƒ¼è¡¨ç¤ºã«ãªã£ã¦ã„ã‚‹å ´åˆã¯ã€æ—¢ã«ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å…ˆãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚Power
Query
ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®å³å´ã«ã‚ã‚‹ã‚¯ã‚¨ãƒªè¨­å®šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ä¸‹éƒ¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å…ˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚æ—¢ã«ä¿å­˜å…ˆãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€æ­¯è»Šã‚¢ã‚¤ã‚³ãƒ³ã‚’ä½¿ã£ã¦å¤‰æ›´ã§ãã¾ã™ã€‚

2.  **Lakehouse**ã®å®›å…ˆã¯ã€Power Query
    ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã®**ã‚¯ã‚¨ãƒª**å†…ã«**ã‚¢ã‚¤ã‚³ãƒ³**ã¨ã—ã¦ç¤ºã•ã‚Œã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image118.png)

![A screenshot of a computer Description automatically
generated](./media/image119.png)

3.  **ã€ŒPublishã€**ã‚’é¸æŠã—ã¦ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’å…¬é–‹ã—ã¾ã™ã€‚ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«**ã€ŒDataflow
    1ã€**ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãŒä½œæˆã•ã‚Œã‚‹ã®ã‚’å¾…ã¡ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image120.png)

![](./media/image121.png)

## ã‚¿ã‚¹ã‚¯ 3: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’è¿½åŠ ã™ã‚‹

ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã¨ã—ã¦å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šè¾¼ã¿ã¨å‡¦ç†ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ä»–ã®ç¨®é¡ã®æ“ä½œã¨çµ„ã¿åˆã‚ã›ãŸå˜ä¸€ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€Data
Factory
ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’å«ã‚€ã„ãã¤ã‹ã®ç•°ãªã‚‹ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã§ä½œæˆã§ãã¾ã™ã€‚

1.  Synapse Data Engineeringã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã§ã¯ã€ ä¸‹
    **dp_FabricXX**ãƒšã‚¤ãƒ³ã§ã€ **+ New item** -\> **Data
    pipeline**ã‚’é¸æŠã—ã¾ã™ã€‚

![](./media/image122.png)

2.  **\[New pipeline\]ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒœãƒƒã‚¯ã‚¹**ã§ã€
    **\[Name\]ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**ã«**ã€ŒLoad dataã€ã¨å…¥åŠ›ã—**ã€
    **\[Create\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ–°ã—ã„ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é–‹ãã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image123.png)

3.  ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãŒé–‹ãã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image124.png)

> **ãƒ’ãƒ³ãƒˆ**: ãƒ‡ãƒ¼ã‚¿ã®ã‚³ãƒ”ãƒ¼
> ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ãŒè‡ªå‹•çš„ã«é–‹ã„ãŸå ´åˆã¯ã€é–‰ã˜ã¦ãã ã•ã„ã€‚

4.  **Pipeline
    activity**ã‚’é¸æŠã—ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«**Dataflow**ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚

![](./media/image125.png)

5.  æ–°ã—ã„**Dataflow1**ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’é¸æŠã—ãŸçŠ¶æ…‹ã§ã€
    **\[Settings\]ã‚¿ãƒ–ã®\[Dataflow\]**ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ ãƒªã‚¹ãƒˆã§ã€
    **Gen2_Dataflow** (ä»¥å‰ã«ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)ã‚’é¸æŠã—ã¾ã™ã€‚

![](./media/image126.png)

6.  **\[Home\]ã‚¿ãƒ–**ã§ã€ **ğŸ–«
    (*ä¿å­˜*)ã‚¢ã‚¤ã‚³ãƒ³**ã‚’ä½¿ç”¨ã—ã¦ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ä¿å­˜ã—ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image127.png)

7.  **â–·ã€ŒRunã€**ãƒœã‚¿ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’å®Ÿè¡Œã—ã€å®Œäº†ã™ã‚‹ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€‚å®Œäº†ã¾ã§æ•°åˆ†ã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

> ![A screenshot of a computer Description automatically
> generated](./media/image128.png)
>
> ![A screenshot of a computer AI-generated content may be
> incorrect.](./media/image129.png)

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image130.png)

8.  å·¦ç«¯ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ ãƒãƒ¼ã§ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹
    (ã¤ã¾ã‚Š**dp_FabricXX)ã‚’**é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image131.png)

![A screenshot of a computer Description automatically
generated](./media/image132.png)

9.  **Fabric_lakehouseãƒšã‚¤ãƒ³**ã§ã€ Lakehouse
    ã‚¿ã‚¤ãƒ—ã®**Gen2_FabricLakehouse**ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer AI-generated content may be
incorrect.](./media/image133.png)

![A screenshot of a computer Description automatically
generated](./media/image134.png)

10. **Explorer**ãƒšã‚¤ãƒ³ã§ã€ **ã€ŒTablesã€**ã®**ã€Œâ€¦ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠã—**ã€
    **ã€ŒRefreshã€**ã‚’é¸æŠã—ã¾ã™ã€‚æ¬¡ã«ã€
    **ã€ŒTablesã€**ã‚’å±•é–‹ã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã«ã‚ˆã£ã¦ä½œæˆã•ã‚ŒãŸ**ã€Œordersã€**ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚

![A screenshot of a computer Description automatically
generated](./media/image135.png)

![](./media/image136.png)

**ãƒ’ãƒ³ãƒˆ**: Power BI Desktop*ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
ã‚³ãƒã‚¯ã‚¿ã‚’ä½¿ç”¨ã—ã¦*ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã§å®Ÿè¡Œã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿å¤‰æ›ã«ç›´æ¥æ¥ç¶šã—ã¾ã™ã€‚

è¿½åŠ ã®å¤‰æ›ã‚’è¡Œã£ã¦æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã—ã¦å…¬é–‹ã—ã€ç‰¹æ®Šãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é…å¸ƒã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

## ã‚¿ã‚¹ã‚¯4: ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹

ã“ã®æ¼”ç¿’ã§ã¯ã€Spark ã‚’ä½¿ç”¨ã—ã¦ Microsoft Fabric
ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹æ–¹æ³•ã‚’å­¦ç¿’ã—ã¾ã—ãŸã€‚

Lakehouseã®æ¢ç´¢ãŒçµ‚äº†ã—ãŸã‚‰ã€ã“ã®æ¼”ç¿’ç”¨ã«ä½œæˆã—ãŸãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’å‰Šé™¤ã§ãã¾ã™ã€‚

1.  å·¦å´ã®ãƒãƒ¼ã§ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’é¸æŠã™ã‚‹ã¨ã€ãã“ã«å«ã¾ã‚Œã‚‹ã™ã¹ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

> ![A screenshot of a computer Description automatically
> generated](./media/image137.png)

2.  **â€¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼**ã§ã€**Workspace settings**ã‚’é¸æŠã—ã¾ã™ã€‚

![](./media/image138.png)

3.  **\[General\]**ã‚’é¸æŠã—ã€ **\[Remove this workspace\]
    ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚**

![A screenshot of a computer settings Description automatically
generated](./media/image139.png)

4.  **\[Delete workspace?\]**ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ãƒœãƒƒã‚¯ã‚¹ã§ã€
    **\[Delete\]**ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

> ![A screenshot of a computer Description automatically
> generated](./media/image140.png)
>
> ![A screenshot of a computer Description automatically
> generated](./media/image141.png)

**ã¾ã¨ã‚**

ã“ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€Power BI å†…ã§ Microsoft Fabric
ã‚’æ“ä½œã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’è§£èª¬ã—ã¾ã™ã€‚ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®è¨­å®šã€Lakehouseã®ä½œæˆã€ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨ç®¡ç†ã€ãƒãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½¿ã£ãŸãƒ‡ãƒ¼ã‚¿æ¢ç´¢ãªã©ã€æ§˜ã€…ãªã‚¿ã‚¹ã‚¯ã‚’ç¶²ç¾…ã—ã¦ã„ã¾ã™ã€‚å‚åŠ è€…ã¯ã€PySpark
ã‚’ä½¿ã£ãŸãƒ‡ãƒ¼ã‚¿ã®æ“ä½œã¨å¤‰æ›ã€ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã®ä½œæˆã€åŠ¹ç‡çš„ãªã‚¯ã‚¨ãƒªå®Ÿè¡Œã®ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã¨ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åˆ†å‰²ã®æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚

ã“ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€å‚åŠ è€…ã¯Microsoft
Fabricã®å·®åˆ†ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ“ä½œã«ç„¦ç‚¹ã‚’å½“ã¦ãŸä¸€é€£ã®ã‚¿ã‚¹ã‚¯ã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚ã‚¿ã‚¹ã‚¯ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¨æ¢ç´¢ã€ãƒãƒãƒ¼ã‚¸ãƒ‰ãŠã‚ˆã³å¤–éƒ¨å·®åˆ†ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆã€ãã‚Œã‚‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®æ¯”è¼ƒãŒå«ã¾ã‚Œã¾ã™ã€‚ãƒ©ãƒœã§ã¯ã€æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®SQLæ©Ÿèƒ½ã‚’ç´¹ä»‹ã—ã€matplotlibã‚„seabornãªã©ã®Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿è¦–è¦šåŒ–ã«é–¢ã™ã‚‹æ´å¯Ÿã‚’æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®æ¼”ç¿’ã¯ã€Microsoft
Fabricã‚’ãƒ‡ãƒ¼ã‚¿åˆ†æã«æ´»ç”¨ã—ã€
IoTã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã«å·®åˆ†ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’çµ„ã¿è¾¼ã‚€æ–¹æ³•ã«ã¤ã„ã¦åŒ…æ‹¬çš„ã«ç†è§£ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ã¯ã€Fabric
ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®è¨­å®šã€ãƒ‡ãƒ¼ã‚¿Lakehouseã®ä½œæˆã€åˆ†æç”¨ãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šè¾¼ã¿ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’è§£èª¬ã—ã¾ã™ã€‚ETL
å‡¦ç†ã‚’å‡¦ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®å®šç¾©æ–¹æ³•ã¨ã€å¤‰æ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜å…ˆã¨ãªã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚¹ãƒ†ã‚£ãƒãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šæ–¹æ³•ã‚‚ç´¹ä»‹ã—ã¾ã™ã€‚ã•ã‚‰ã«ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆã—ã¦è‡ªå‹•å‡¦ç†ã‚’å®Ÿç¾ã™ã‚‹æ–¹æ³•ã‚‚å­¦ç¿’ã—ã¾ã™ã€‚æœ€å¾Œã«ã€æ¼”ç¿’å®Œäº†å¾Œã«ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹æ‰‹é †ã«ã¤ã„ã¦ã‚‚èª¬æ˜ã—ã¾ã™ã€‚

ã“ã®ãƒ©ãƒœã§ã¯ã€Fabric
ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã—ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ä½œæˆã¨ç®¡ç†ã€ãƒ‡ãƒ¼ã‚¿Lakehouseã®æ§‹ç¯‰ã€ãã—ã¦åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿å¤‰æ›ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ„ã¿è¾¼ã‚€ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•åŒ–ã—ã€ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’åŠ¹ç‡åŒ–ã—ã€å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªã«ãŠã‘ã‚‹ç”Ÿç”£æ€§ã‚’å‘ä¸Šã•ã›ã‚‹æ–¹æ³•ã‚’ç¿’å¾—ã§ãã¾ã™ã€‚ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ‰‹é †ã«å¾“ã†ã“ã¨ã§ã€ä¸è¦ãªãƒªã‚½ãƒ¼ã‚¹ã‚’æ®‹ã•ãšã€æ•´ç†ã•ã‚ŒãŸåŠ¹ç‡çš„ãªãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç®¡ç†ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’å®Ÿç¾ã§ãã¾ã™ã€‚
